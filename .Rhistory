plot.loh.tcga.bridges.genes.all <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~bridges_genes, scale="free")
plot.loh.tcga.bridges.genes.all
plot.loh.tcga.bridges.genes.all <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
plot.loh.tcga.bridges.genes.all
plot.loh.tcga.bridges.genes.all.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_bar(stat="identity")+scale_fill_hue()+facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
stats.loh.tcga.all.tumor.types.AF <- stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq_AF, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq_AF, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq_AF, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq*100,digits = 1), fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
stats.loh.tcga.all.tumor.types.AF
df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% distinct_at(vars(Sample),.keep_all=T) %>% group_by(Type) %>% dplyr::summarise(n = n()) ### here breast caner are 28 patients less
stats.loh.tcga.all.tumor.types
df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(LOH == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
view(stats.loh.tcga.all.tumor.types)
stats.loh.tcga.all.tumor.types <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(LOH == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
view(stats.loh.tcga.all.tumor.types)
stats.loh.tcga.all.tumor.types <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(LOH == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
view(stats.loh.tcga.all.tumor.types)
stats.loh.tcga.all.tumor.types <- merge(stats.loh.tcga.all.tumor.types,total_number_cases_tcga,by="Type")
setnames(stats.loh.tcga.all.tumor.types,old=c("n.x","n.y"),new = c("ncases_loh",  "total_sample"))
stats.loh.tcga.all.tumor.types.AF <- stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5)
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5,EI=1/(1-freq))
1/(1-0.333333333)
##plot 1/(1-0.333333333)
stats.loh.tcga.all.tumor.types.AF <- stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5,EI=1/(1-freq))
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
+facet_wrap(~Type, scale="free")
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free")
####plot EI
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
#plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=freq, fill=Type))+ geom_boxplot()+facet_wrap(~Type, scale="free")
#  geom_bar(stat="identity")+scale_fill_hue()
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA")
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA") %>% ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))
plot.EI.loh.tcga.bridges.genes.BRCA <-ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))
#facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
stats.loh.tcga.all.tumor.types.AF <- stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5,EI=1/(1-freq_AF))
####plot EI
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <-ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))
#facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
stats.loh.tcga.all.tumor.types.AF
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
##plot
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
1/(1-0.1094059406)
1/(1-0.1666666667)
stats.loh.tcga.all.tumor.types.AF <- stats.loh.tcga.all.tumor.types %>% mutate(freq = ncases_loh/total_sample,freq_AF = (ncases_loh/total_sample)*0.5,EI=1/(1-freq_AF))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_bar(stat="identity")+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
scale_y_continuous(labels = function(x) paste0(x),breaks=c(0), limits=c(1,3))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_boxplot()+scale_fill_hue()
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
scale_y_continuous(labels = function(x) paste0(x),breaks=c(0), limits=c(1,3))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
scale_y_continuous(labels = function(x) paste0(x),breaks=c(0), limits=c(1,1.7))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
scale_y_continuous(labels = function(x) paste0(x),limits=c(1,1.7))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point()+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
#geom_bar(stat="identity")+
geom_point()+scale_fill_hue() +
scale_fill_hue()+
theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
#geom_bar(stat="identity")+
geom_point()+
scale_fill_hue()+
theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
##plot
plot.loh.tcga.bridges.genes.all.tumor.types.freq <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=round(freq_AF*100,digits = 1), fill=Type))+
#geom_bar(stat="identity")+
geom_point()+
scale_fill_hue()+
theme(axis.text.x = element_text(size=8,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))+
facet_wrap(~Type, scale="free")
ggsave(filename = paste0("figures/plot.loh.tcga.bridges.genes.all.tumor.types.freq.pdf"), plot = plot.loh.tcga.bridges.genes.all.tumor.types.freq, width = 48, height = 28)
####plot EI
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point()+scale_fill_hue()+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
####plot EI
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point(size = 3)+scale_fill_hue()+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 3)+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point(size = 5)+scale_fill_hue()+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point(size = 4)+scale_fill_hue()+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point(size = 4)+scale_fill_hue(l = 40, c = 30)+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=18,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=18,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=18,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=18,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
#scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22)) +scale_y_continuous(labels =limits=c(1,2))
ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22)) +scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
plot.EI.loh.tcga.bridges.genes.all.tumor.types <- ggplot(stats.loh.tcga.all.tumor.types.AF,aes(x=bridges_genes,y=EI, fill=Type))+
#geom_bar(stat="identity")+scale_fill_hue()+
geom_point(size = 4)+scale_fill_hue(l = 40, c = 30)+
theme(axis.text.x = element_text(size=12,angle = 90, vjust = 1,hjust=1),axis.text.y = element_text(size=12,angle = 90, vjust = 1,hjust=1))+
scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2)) +
facet_wrap(~Type, scale="free") #scale_y_continuous(labels = function(x) paste0(x, "%"),breaks=c(0,20,40,60,80,100), limits=c(0,100))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.all.tumor.types_updated.pdf"), plot = plot.EI.loh.tcga.bridges.genes.all.tumor.types, width = 48, height = 28)
plot.EI.loh.tcga.bridges.genes.BRCA <- ggplot(stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA"),aes(x=bridges_genes,y=EI, fill=Type))+
geom_point(size = 8)+scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22)) +scale_y_continuous(labels = function(x) paste0(x),limits=c(1,2))
ggsave(filename = paste0("plot.EI.loh.tcga.bridges.genes.BRCA_updated_y-axis.pdf"), plot = plot.EI.loh.tcga.bridges.genes.BRCA, width = 48, height = 28)
nejm$fraq.cases.3
nejm=read.table(file="/Users/samuelahuno/Polak_lab10082019/bridges_breast/data/bridges.genes.freq.tsv",header = T,sep = '\t')
setnames(nejm, old = c("gene","case","control"), new = c("Gene","ncases","ncontrols"))
#colnames(nejm)=c("Gene","ncases","ncontrols")
total_cases=48826
total_controls=50703
nejm$fraq.cases=nejm$ncases/total_cases
nejm$fraq.controls=nejm$ncontrols/total_controls
nejm$fraq.cases.1000=round(nejm$ncases/total_cases*1000)
nejm$fraq.controls.1000=round(nejm$ncontrols/total_controls*1000)
nejm$fraq.cases.10000=round(nejm$ncases/total_cases*10000)
nejm$fraq.controls.10000=round(nejm$ncontrols/total_controls*10000)
nejm$fraq.cases.3=round((total_cases*3)/nejm$ncases)
nejm$fraq.controls.3=round((total_controls*3)/nejm$ncontrols)
fraq.cases.3
nejm
nejm$fraq.cases.3
nejm
nejm=read.table(file="/Users/samuelahuno/Polak_lab10082019/bridges_breast/data/bridges.genes.freq.tsv",header = T,sep = '\t')
setnames(nejm, old = c("gene","case","control"), new = c("Gene","ncases","ncontrols"))
#colnames(nejm)=c("Gene","ncases","ncontrols")
total_cases=48826
total_controls=50703
nejm$fraq.cases=nejm$ncases/total_cases
nejm$fraq.controls=nejm$ncontrols/total_controls
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA")
##source
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA") %>% select(Type,bridges_genes,freq_AF)
##source
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA") %>% select(c(Type,bridges_genes,freq_AF))
##source
stats.loh.tcga.all.tumor.types.AF %>% select(c(Type,bridges_genes,freq_AF))
stats.loh.tcga.all.tumor.types.AF %>% filter (Type=="BRCA")
stats.loh.tcga.all.tumor.types.AF %>% dplyr::filter (Type=="BRCA")
##source
stats.loh.tcga.all.tumor.types.AF %>% dplyr::filter (Type=="BRCA") %>% dplyr::select(c(Type,bridges_genes,freq_AF))
nejm
biallelic_info
##source
biallelic_info <- stats.loh.tcga.all.tumor.types.AF %>% dplyr::filter (Type=="BRCA") %>% dplyr::select(c(Type,bridges_genes,freq_AF))
biallelic_info
merge(nejm,biallelic_info,by.x="Gene",by.y="bridges_genes")
##source
biallelic_info <- stats.loh.tcga.all.tumor.types.AF %>% dplyr::filter (Type=="BRCA") %>% dplyr::select(c(Type,bridges_genes,freq_AF))
nejm_biallelic_info <- merge(nejm,biallelic_info,by.x="Gene",by.y="bridges_genes")
nejm$fraq.controls*freq_AF
nejm_biallelic_info$fraq.controls*nejm_biallelic_info$freq_AF
nejm_biallelic_info$expected_loh <- nejm_biallelic_info$fraq.controls*nejm_biallelic_info$freq_AF
nejm_biallelic_info
(nejm_biallelic_info$fraq.controls*nejm_biallelic_info$freq_AF)*10000
nejm_biallelic_info
ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+geom_point(size = 8)+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+geom_point(size = 8)+ geom_bar(stat="identity")+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+ geom_bar(stat="identity")+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+ geom_bar(stat="identity")+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
nejm_biallelic_info$expected_loh <- (nejm_biallelic_info$fraq.controls*nejm_biallelic_info$freq_AF)*10000
nejm_biallelic_info
ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+ geom_bar(stat="identity")+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
#ggsave(filename = pa
plot.expected.loh <- ggplot(nejm_biallelic_info,aes(x=Gene,y=expected_loh))+ geom_bar(stat="identity")+
scale_fill_hue()+ theme(axis.text.x = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.text.y = element_text(size=22,angle = 90, vjust = 1,hjust=1),
axis.title=element_text(size=22))
ggsave(filename = paste0("figures/plot.expected.loh.bridges.pdf"), plot = plot.expected.loh, width = 48, height = 28)
biallelic_info
interest_g <- c("MLH1", "MSH6", "PMS2", "MSH2")
nejm_biallelic_info %>% filter(bridges_genes %in% c("MLH1", "MSH6", "PMS2", "MSH2"))
nejm_biallelic_info %>% filter(bridges_genes %in% c("MLH1", "MSH6", "PMS2", "MSH2"))
nejm_biallelic_info %>% filter(bridges_genes == c("MLH1", "MSH6", "PMS2", "MSH2"))
nejm_biallelic_info %>% filter(bridges_genes %in% c("MLH1","MSH6","PMS2","MSH2"))
nejm_biallelic_info
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2"))
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>%
mutate(expected_loh_genes = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>%
mutate(expected_loh_genes = sum((fraq.controls*freq_AF)*100000))
interest_g <- c("MLH1", "MSH6", "PMS2", "MSH2")
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>%
(expected_loh_genes = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>%
(expected_loh_genes = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% (expected_loh_genes = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% mutate(expected_loh_genes = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% mutate(expected_loh_genes2 = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% mutate(expected_loh_msi = (fraq.controls*freq_AF)*100000)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% mutate(expected_loh_msi = (fraq.controls*freq_AF)*100000) %>% sum(expected_loh_msi)
nejm_biallelic_info %>% filter(Gene %in% c("MLH1","MSH6","PMS2","MSH2")) %>% mutate(expected_loh_msi = (fraq.controls*freq_AF)*100000) %>% summarise(sum(expected_loh_msi))
library(data.table)
library(tidyverse)
library(biomaRt)
library(GenomeInfoDb)
library(GenomicFeatures)
library(reshape2)
library(plyr)
library(ggpubr)
library(RColorBrewer)
library(hablar)
library(ggplot2)
##read the tcga absolute master calls
df.tcga.mastercalls.abs <- fread("/Users/samuelahuno/Downloads/TCGA_mastercalls.abs_segtabs.fixed.txt", sep = "\t", header= TRUE)
##sanity checks
head(df.tcga.mastercalls.abs)
dim(df.tcga.mastercalls.abs)
###how many unique sample
df.tcga.mastercalls.abs %>% distinct(Sample) %>% dplyr::summarise(n()) #1 11084
###retrive cancer types
df.tcga.aneuploidy <- fread("/Users/samuelahuno/Downloads/PANCAN_ArmCallsAndAneuploidyScore_092817.txt", sep = "\t", header= TRUE)
##merged table to append tumor types key
merged.tcga.mastercalls.abs.tumor.ID <- merge(df.tcga.mastercalls.abs, df.tcga.aneuploidy,by.x="Sample",by.y="Sample",no.dups=TRUE)
dim(merged.tcga.mastercalls.abs.tumor.ID)
table(merged.tcga.mastercalls.abs.tumor.ID$Type)
### read breast cacner genes from bridges study
source("/Users/samuelahuno/Polak_lab10082019/bridges_breast/scripts/getCytobandsHg19_bridges_genes.R")
### read breast cacner genes from bridges study
source("/Users/samuelahuno/Polak_lab10082019/bridges_breast/scripts/getCytobandsHg19_bridges_genes.R")
cordinates.bridges.genes.hg19
##find overlaps
gr.loh.merged.tcga.mastercalls.abs.tumor.ID <- makeGRangesFromDataFrame(loh.merged.tcga.mastercalls.abs.tumor.ID,start.field=  "Start", end.field= "End", seqnames.field="Chromosome", keep.extra.columns = T)
###retrive cancer types
df.tcga.aneuploidy <- fread("/Users/samuelahuno/Downloads/PANCAN_ArmCallsAndAneuploidyScore_092817.txt", sep = "\t", header= TRUE)
##merged table to append tumor types key
merged.tcga.mastercalls.abs.tumor.ID <- merge(df.tcga.mastercalls.abs, df.tcga.aneuploidy,by.x="Sample",by.y="Sample",no.dups=TRUE)
dim(merged.tcga.mastercalls.abs.tumor.ID)
merged.tcga.mastercalls.abs.tumor.ID
table(merged.tcga.mastercalls.abs.tumor.ID$Type)
### read breast cacner genes from bridges study
source("/Users/samuelahuno/Polak_lab10082019/bridges_breast/scripts/getCytobandsHg19_bridges_genes.R")
cordinates.bridges.genes.hg19
##find overlaps
gr.loh.merged.tcga.mastercalls.abs.tumor.ID <- makeGRangesFromDataFrame(loh.merged.tcga.mastercalls.abs.tumor.ID,start.field=  "Start", end.field= "End", seqnames.field="Chromosome", keep.extra.columns = T)
loh.merged.tcga.mastercalls.abs.tumor.ID
##find overlaps
gr.loh.merged.tcga.mastercalls.abs.tumor.ID <- makeGRangesFromDataFrame(merged.tcga.mastercalls.abs.tumor.ID,start.field=  "Start", end.field= "End", seqnames.field="Chromosome", keep.extra.columns = T)
ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID<- findOverlaps(query=cordinates.bridges.genes.hg19, subject=gr.loh.merged.tcga.mastercalls.abs.tumor.ID, type = "within") ##complete overlaps
####append, gene names to columns
gr.loh.merged.tcga.mastercalls.abs.tumor.ID$bridges_genes <- NA
mcols(gr.loh.merged.tcga.mastercalls.abs.tumor.ID)$bridges_genes[subjectHits(ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID)] <- mcols(cordinates.bridges.genes.hg19)$hgnc_symbol[queryHits(ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID)]
##convert to data frame
df.loh.merged.tcga.mastercalls.abs.tumor.ID <- as.data.frame(gr.loh.merged.tcga.mastercalls.abs.tumor.ID)
df.loh.merged.tcga.mastercalls.abs.tumor.ID <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% drop_na(bridges_genes)
dim(df.loh.merged.tcga.mastercalls.abs.tumor.ID)
###how many patiets are there in each cancer type
total_number_cases_tcga <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% distinct_at(vars(Sample),.keep_all=T) %>% group_by(Type) %>% dplyr::summarise(n = n()) ### here breast caner are 28 patients less
df.loh.merged.tcga.mastercalls.abs.tumor.ID
##extrcat only loh
stats.loh.tcga.all.tumor.types <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(Homozygous_deletion == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
view(stats.loh.tcga.all.tumor.types)
stats.loh.tcga.all.tumor.types
stats.loh.tcga.all.tumor.types %>%filter(Type=="BRCA" & bridges_genes == "BARD1") #%>%
df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(Homozygous_deletion == 1) %>%filter(Type=="BRCA" & bridges_genes == "BARD1")
library(data.table)
library(tidyverse)
library(biomaRt)
library(GenomeInfoDb)
library(GenomicFeatures)
library(reshape2)
library(plyr)
library(ggpubr)
library(RColorBrewer)
library(hablar)
library(ggplot2)
##read the tcga absolute master calls
df.tcga.mastercalls.abs <- fread("/Users/samuelahuno/Downloads/TCGA_mastercalls.abs_segtabs.fixed.txt", sep = "\t", header= TRUE)
##sanity checks
head(df.tcga.mastercalls.abs)
dim(df.tcga.mastercalls.abs)
###how many unique sample
df.tcga.mastercalls.abs %>% distinct(Sample) %>% dplyr::summarise(n()) #1 11084
###retrive cancer types
df.tcga.aneuploidy <- fread("/Users/samuelahuno/Downloads/PANCAN_ArmCallsAndAneuploidyScore_092817.txt", sep = "\t", header= TRUE)
##merged table to append tumor types key
merged.tcga.mastercalls.abs.tumor.ID <- merge(df.tcga.mastercalls.abs, df.tcga.aneuploidy,by.x="Sample",by.y="Sample",no.dups=TRUE)
dim(merged.tcga.mastercalls.abs.tumor.ID)
table(merged.tcga.mastercalls.abs.tumor.ID$Type)
### read breast cacner genes from bridges study
source("/Users/samuelahuno/Polak_lab10082019/bridges_breast/scripts/getCytobandsHg19_bridges_genes.R")
cordinates.bridges.genes.hg19
##find overlaps
gr.loh.merged.tcga.mastercalls.abs.tumor.ID <- makeGRangesFromDataFrame(merged.tcga.mastercalls.abs.tumor.ID,start.field=  "Start", end.field= "End", seqnames.field="Chromosome", keep.extra.columns = T)
ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID<- findOverlaps(query=cordinates.bridges.genes.hg19, subject=gr.loh.merged.tcga.mastercalls.abs.tumor.ID, type = "within") ##complete overlaps
####append, gene names to columns
gr.loh.merged.tcga.mastercalls.abs.tumor.ID$bridges_genes <- NA
mcols(gr.loh.merged.tcga.mastercalls.abs.tumor.ID)$bridges_genes[subjectHits(ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID)] <- mcols(cordinates.bridges.genes.hg19)$hgnc_symbol[queryHits(ov.gr.loh.merged.tcga.mastercalls.abs.tumor.ID)]
##convert to data frame
df.loh.merged.tcga.mastercalls.abs.tumor.ID <- as.data.frame(gr.loh.merged.tcga.mastercalls.abs.tumor.ID)
df.loh.merged.tcga.mastercalls.abs.tumor.ID <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% drop_na(bridges_genes)
dim(df.loh.merged.tcga.mastercalls.abs.tumor.ID)
###how many patiets are there in each cancer type
total_number_cases_tcga <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% distinct_at(vars(Sample),.keep_all=T) %>% group_by(Type) %>% dplyr::summarise(n = n()) ### here breast caner are 28 patients less
total_number_cases_tcga
df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(Homozygous_deletion == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
##extrcat only loh
stats.loh.tcga.all.tumor.types <- df.loh.merged.tcga.mastercalls.abs.tumor.ID %>% filter(Homozygous_deletion == 1) %>% group_by(Type,bridges_genes) %>% dplyr::summarise(n = n()) #%>% mutate(freq = n /1048,freq_AF = (n /1048)*0.5)
stats.loh.tcga.all.tumor.types
view(stats.loh.tcga.all.tumor.types)
view(stats.loh.tcga.all.tumor.types)
library(readxl)
dataset <- read_excel(NULL)
View(dataset)
library(readxl)
supp_mcs_a003681_Supplemental_Table_S1_cancer_types_MUTYH_status <- read_excel("data/supp_mcs.a003681_Supplemental_Table_S1_cancer_types_MUTYH_status.xlsx")
View(supp_mcs_a003681_Supplemental_Table_S1_cancer_types_MUTYH_status)
library(readxl)
supp_mcs_a003681_Supplemental_Table_S1_cancer_types_MUTYH_status <- read_excel("data/supp_mcs.a003681_Supplemental_Table_S1_cancer_types_MUTYH_status.xlsx")
View(supp_mcs_a003681_Supplemental_Table_S1_cancer_types_MUTYH_status)
my_data <- read.table(pipe("~/Polak_lab10082019/bridges_breast/data/supp_mcs.a003681_Supplemental_Table_S1_cancer_types_MUTYH_status.xlsx"), sep="\t", header = TRUE)
read.table(pipe("~/Polak_lab10082019/bridges_breast/data/supp_mcs.a003681_Supplemental_Table_S1_cancer_types_MUTYH_status.xlsx"), sep="\t", header = TRUE)
library(readxl)
sup_table1 <- read_excel("data/supp_mcs.a003681_Supplemental_Table_S1_cancer_types_MUTYH_status.xlsx")
View(sup_table1)
View(sup_table1)
names(sup_table1)
gsub(" ","_",names(sup_table1))
names(sup_table1) <- gsub(" ","_",names(sup_table1))
sup_table1
sup_table1 %>% filter(grepl("Breast", Oncotree_tumour_type))
library(tidyverse)
sup_table1 %>% filter(grepl("Breast", Oncotree_tumour_type))
##count number of breast
sup_table1 %>% filter(grepl("Breast", Oncotree_tumour_type)) %>% summarise(sum())
sup_table1 %>% filter(grepl("Breast", Oncotree_tumour_type))
##count number of breast
sup_table1 %>% filter(grepl("Breast", Oncotree_tumour_type)) %>% summarise(sum(count))
sup_table1 %>% summarise(sum(count))
R.Version()
###retrive cancer types
df.tcga.aneuploidy <- read.delim("/Users/samuelahuno/Downloads/PANCAN_ArmCallsAndAneuploidyScore_092817.txt", sep = "\t", header= TRUE)
df.tcga.aneuploidy
which(df.tcga.aneuploidy$Type == "BRCA")
df.tcga.aneuploidy[which(df.tcga.aneuploidy$Type == "BRCA")]
df.tcga.aneuploidy[which(df.tcga.aneuploidy$Type == "BRCA"),]
brca.ids <- df.tcga.aneuploidy[which(df.tcga.aneuploidy$Type == "BRCA"),]
brca.ids
